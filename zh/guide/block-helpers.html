<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>块助手代码 | Handlebars</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.562dba8f.css" as="style"><link rel="preload" href="/assets/js/app.66f79011.js" as="script"><link rel="preload" href="/assets/js/2.aef76e4d.js" as="script"><link rel="preload" href="/assets/js/158.8e8b55c0.js" as="script"><link rel="preload" href="/assets/js/9.07b9d2e0.js" as="script"><link rel="preload" href="/assets/js/13.9cff3425.js" as="script"><link rel="prefetch" href="/assets/js/1.63d23596.js"><link rel="prefetch" href="/assets/js/10.c3e990be.js"><link rel="prefetch" href="/assets/js/100.af1a2a9b.js"><link rel="prefetch" href="/assets/js/101.c6fe2aab.js"><link rel="prefetch" href="/assets/js/102.76ab1c2a.js"><link rel="prefetch" href="/assets/js/103.ee9ea6f3.js"><link rel="prefetch" href="/assets/js/104.fdcfbf05.js"><link rel="prefetch" href="/assets/js/105.e0bacf66.js"><link rel="prefetch" href="/assets/js/106.fa9e3d9c.js"><link rel="prefetch" href="/assets/js/107.668c0295.js"><link rel="prefetch" href="/assets/js/108.362e8d87.js"><link rel="prefetch" href="/assets/js/109.8e2650e9.js"><link rel="prefetch" href="/assets/js/11.5b2b1c7a.js"><link rel="prefetch" href="/assets/js/110.feea588a.js"><link rel="prefetch" href="/assets/js/111.72290d8d.js"><link rel="prefetch" href="/assets/js/112.fda664ad.js"><link rel="prefetch" href="/assets/js/113.ae651caf.js"><link rel="prefetch" href="/assets/js/114.c5fbde10.js"><link rel="prefetch" href="/assets/js/115.9d512f4f.js"><link rel="prefetch" href="/assets/js/116.688674a5.js"><link rel="prefetch" href="/assets/js/117.63048a79.js"><link rel="prefetch" href="/assets/js/118.1fe20893.js"><link rel="prefetch" href="/assets/js/119.0655e41c.js"><link rel="prefetch" href="/assets/js/12.9cf4a820.js"><link rel="prefetch" href="/assets/js/120.804069ca.js"><link rel="prefetch" href="/assets/js/121.94d60790.js"><link rel="prefetch" href="/assets/js/122.ed24a600.js"><link rel="prefetch" href="/assets/js/123.49cbda16.js"><link rel="prefetch" href="/assets/js/124.85690f8f.js"><link rel="prefetch" href="/assets/js/125.321da1a5.js"><link rel="prefetch" href="/assets/js/126.110e97a5.js"><link rel="prefetch" href="/assets/js/127.4f33fc5e.js"><link rel="prefetch" href="/assets/js/128.24c7b298.js"><link rel="prefetch" href="/assets/js/129.5d35bf09.js"><link rel="prefetch" href="/assets/js/130.ab35c81d.js"><link rel="prefetch" href="/assets/js/131.87e1a313.js"><link rel="prefetch" href="/assets/js/132.b67aac60.js"><link rel="prefetch" href="/assets/js/133.7ab66025.js"><link rel="prefetch" href="/assets/js/134.c4395399.js"><link rel="prefetch" href="/assets/js/135.076c16da.js"><link rel="prefetch" href="/assets/js/136.da4790ae.js"><link rel="prefetch" href="/assets/js/137.bd491d09.js"><link rel="prefetch" href="/assets/js/138.dbbfada3.js"><link rel="prefetch" href="/assets/js/139.1fa903d6.js"><link rel="prefetch" href="/assets/js/14.40b25f9c.js"><link rel="prefetch" href="/assets/js/140.abd9b39d.js"><link rel="prefetch" href="/assets/js/141.86f56b85.js"><link rel="prefetch" href="/assets/js/142.a8c14d19.js"><link rel="prefetch" href="/assets/js/143.d9df55b6.js"><link rel="prefetch" href="/assets/js/144.0a6d8534.js"><link rel="prefetch" href="/assets/js/145.990e6753.js"><link rel="prefetch" href="/assets/js/146.9dd48ed0.js"><link rel="prefetch" href="/assets/js/147.d7d5cd3d.js"><link rel="prefetch" href="/assets/js/148.f8905a30.js"><link rel="prefetch" href="/assets/js/149.057fcef7.js"><link rel="prefetch" href="/assets/js/15.f797b296.js"><link rel="prefetch" href="/assets/js/150.3eeb920d.js"><link rel="prefetch" href="/assets/js/151.3749249c.js"><link rel="prefetch" href="/assets/js/152.e8d9aed8.js"><link rel="prefetch" href="/assets/js/153.8115ada4.js"><link rel="prefetch" href="/assets/js/154.393a4797.js"><link rel="prefetch" href="/assets/js/155.5de1428d.js"><link rel="prefetch" href="/assets/js/156.e5a8df1f.js"><link rel="prefetch" href="/assets/js/157.6e21f101.js"><link rel="prefetch" href="/assets/js/159.f0187d28.js"><link rel="prefetch" href="/assets/js/16.9047a1ae.js"><link rel="prefetch" href="/assets/js/160.7ede8df5.js"><link rel="prefetch" href="/assets/js/161.d1c1da5b.js"><link rel="prefetch" href="/assets/js/162.2ff142e0.js"><link rel="prefetch" href="/assets/js/163.336d441f.js"><link rel="prefetch" href="/assets/js/164.ca794336.js"><link rel="prefetch" href="/assets/js/165.9910564f.js"><link rel="prefetch" href="/assets/js/166.4d23ca01.js"><link rel="prefetch" href="/assets/js/167.c8ceedd4.js"><link rel="prefetch" href="/assets/js/168.b5275c49.js"><link rel="prefetch" href="/assets/js/169.a0a53e86.js"><link rel="prefetch" href="/assets/js/17.59175173.js"><link rel="prefetch" href="/assets/js/170.9bcc61f4.js"><link rel="prefetch" href="/assets/js/18.b8008d3d.js"><link rel="prefetch" href="/assets/js/19.2c0c173a.js"><link rel="prefetch" href="/assets/js/20.f2edc46e.js"><link rel="prefetch" href="/assets/js/21.eff25d83.js"><link rel="prefetch" href="/assets/js/22.7aaee854.js"><link rel="prefetch" href="/assets/js/23.c88a7d5c.js"><link rel="prefetch" href="/assets/js/24.babf720e.js"><link rel="prefetch" href="/assets/js/25.d0243591.js"><link rel="prefetch" href="/assets/js/26.9fecaa57.js"><link rel="prefetch" href="/assets/js/27.da7f55d9.js"><link rel="prefetch" href="/assets/js/28.59992128.js"><link rel="prefetch" href="/assets/js/29.aaa5ad13.js"><link rel="prefetch" href="/assets/js/3.07daf281.js"><link rel="prefetch" href="/assets/js/30.52551762.js"><link rel="prefetch" href="/assets/js/31.e34abcc9.js"><link rel="prefetch" href="/assets/js/32.5d72a17d.js"><link rel="prefetch" href="/assets/js/33.3853bf96.js"><link rel="prefetch" href="/assets/js/34.4cb9a5ec.js"><link rel="prefetch" href="/assets/js/35.79d03935.js"><link rel="prefetch" href="/assets/js/36.a2b66f44.js"><link rel="prefetch" href="/assets/js/37.d8ede94f.js"><link rel="prefetch" href="/assets/js/38.355f9510.js"><link rel="prefetch" href="/assets/js/39.73b5da52.js"><link rel="prefetch" href="/assets/js/40.37c58cd8.js"><link rel="prefetch" href="/assets/js/41.f31b7dc5.js"><link rel="prefetch" href="/assets/js/42.7e7c6f06.js"><link rel="prefetch" href="/assets/js/43.74221c4a.js"><link rel="prefetch" href="/assets/js/44.1c4edd92.js"><link rel="prefetch" href="/assets/js/45.e623c602.js"><link rel="prefetch" href="/assets/js/46.9e1fac81.js"><link rel="prefetch" href="/assets/js/47.e42689d0.js"><link rel="prefetch" href="/assets/js/48.077db9d7.js"><link rel="prefetch" href="/assets/js/49.7b9ff1a6.js"><link rel="prefetch" href="/assets/js/50.82e896ef.js"><link rel="prefetch" href="/assets/js/51.fcbbd85a.js"><link rel="prefetch" href="/assets/js/52.9ad4049b.js"><link rel="prefetch" href="/assets/js/53.40207d74.js"><link rel="prefetch" href="/assets/js/54.4570027e.js"><link rel="prefetch" href="/assets/js/55.3e752bde.js"><link rel="prefetch" href="/assets/js/56.956e6f65.js"><link rel="prefetch" href="/assets/js/57.edc9b39b.js"><link rel="prefetch" href="/assets/js/58.e0929e89.js"><link rel="prefetch" href="/assets/js/59.5fc27bb8.js"><link rel="prefetch" href="/assets/js/6.46823852.js"><link rel="prefetch" href="/assets/js/60.2ec86aa6.js"><link rel="prefetch" href="/assets/js/61.ab6cfc99.js"><link rel="prefetch" href="/assets/js/62.2e59cabb.js"><link rel="prefetch" href="/assets/js/63.22f966d8.js"><link rel="prefetch" href="/assets/js/64.7d06ff3b.js"><link rel="prefetch" href="/assets/js/65.adcf9e6b.js"><link rel="prefetch" href="/assets/js/66.baabb222.js"><link rel="prefetch" href="/assets/js/67.92f0641d.js"><link rel="prefetch" href="/assets/js/68.ca90a60f.js"><link rel="prefetch" href="/assets/js/69.d97e5deb.js"><link rel="prefetch" href="/assets/js/7.226af66f.js"><link rel="prefetch" href="/assets/js/70.f0965436.js"><link rel="prefetch" href="/assets/js/71.e3acd976.js"><link rel="prefetch" href="/assets/js/72.64c6e012.js"><link rel="prefetch" href="/assets/js/73.54ae9035.js"><link rel="prefetch" href="/assets/js/74.c33345d1.js"><link rel="prefetch" href="/assets/js/75.3e01c8d6.js"><link rel="prefetch" href="/assets/js/76.6b87e199.js"><link rel="prefetch" href="/assets/js/77.c1c407bd.js"><link rel="prefetch" href="/assets/js/78.4e21d8d5.js"><link rel="prefetch" href="/assets/js/79.0401a73a.js"><link rel="prefetch" href="/assets/js/8.232ccea8.js"><link rel="prefetch" href="/assets/js/80.9c4a872c.js"><link rel="prefetch" href="/assets/js/81.d7ae8c63.js"><link rel="prefetch" href="/assets/js/82.1a5033a2.js"><link rel="prefetch" href="/assets/js/83.977d2f5e.js"><link rel="prefetch" href="/assets/js/84.6f2e1824.js"><link rel="prefetch" href="/assets/js/85.abcb3e29.js"><link rel="prefetch" href="/assets/js/86.bc400f06.js"><link rel="prefetch" href="/assets/js/87.75391b9d.js"><link rel="prefetch" href="/assets/js/88.b105fb46.js"><link rel="prefetch" href="/assets/js/89.9d9e9404.js"><link rel="prefetch" href="/assets/js/90.389ec10e.js"><link rel="prefetch" href="/assets/js/91.fa114d8c.js"><link rel="prefetch" href="/assets/js/92.b2173432.js"><link rel="prefetch" href="/assets/js/93.e6caa99c.js"><link rel="prefetch" href="/assets/js/94.819a1b63.js"><link rel="prefetch" href="/assets/js/95.02f8b5ef.js"><link rel="prefetch" href="/assets/js/96.4db248d2.js"><link rel="prefetch" href="/assets/js/97.86f6a1fa.js"><link rel="prefetch" href="/assets/js/98.15f0e0c6.js"><link rel="prefetch" href="/assets/js/99.986ae56d.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.aa95f055.js"><link rel="prefetch" href="/b9f42da668e007dc95d5.worker.js">
    <link rel="stylesheet" href="/assets/css/0.styles.562dba8f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zh/" class="home-link router-link-active"><!----> <span class="site-name">Handlebars</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zh/guide/" class="nav-link router-link-active">
  语言指南
</a></div><div class="nav-item"><a href="/zh/installation/" class="nav-link">
  安装
</a></div><div class="nav-item"><a href="/zh/api-reference/" class="nav-link">
  API 参考
</a></div><div class="nav-item"><a href="/zh/contributing/" class="nav-link">
  改进文档
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="语言" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/block-helpers.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/guide/block-helpers.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  中文
</a></li></ul></div></div> <a href="https://github.com/wycats/handlebars.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zh/guide/" class="nav-link router-link-active">
  语言指南
</a></div><div class="nav-item"><a href="/zh/installation/" class="nav-link">
  安装
</a></div><div class="nav-item"><a href="/zh/api-reference/" class="nav-link">
  API 参考
</a></div><div class="nav-item"><a href="/zh/contributing/" class="nav-link">
  改进文档
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><span class="title">语言</span> <span class="arrow down"></span></button> <button type="button" aria-label="语言" class="mobile-dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/guide/block-helpers.html" class="nav-link">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh/guide/block-helpers.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  中文
</a></li></ul></div></div> <a href="https://github.com/wycats/handlebars.js" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/zh/guide/" aria-current="page" class="sidebar-link">介绍</a></li><li><a href="/zh/guide/expressions.html" class="sidebar-link">表达式</a></li><li><a href="/zh/guide/partials.html" class="sidebar-link">代码片段</a></li><li><a href="/zh/guide/block-helpers.html" aria-current="page" class="active sidebar-link">块助手代码</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh/guide/block-helpers.html#基本代码块" class="sidebar-link">基本代码块</a></li><li class="sidebar-sub-header"><a href="/zh/guide/block-helpers.html#基本代码块的变化" class="sidebar-link">基本代码块的变化</a></li><li class="sidebar-sub-header"><a href="/zh/guide/block-helpers.html#with-助手代码" class="sidebar-link">with 助手代码</a></li><li class="sidebar-sub-header"><a href="/zh/guide/block-helpers.html#简单迭代" class="sidebar-link">简单迭代</a></li><li class="sidebar-sub-header"><a href="/zh/guide/block-helpers.html#条件" class="sidebar-link">条件</a></li><li class="sidebar-sub-header"><a href="/zh/guide/block-helpers.html#hash-参数" class="sidebar-link">Hash 参数</a></li><li class="sidebar-sub-header"><a href="/zh/guide/block-helpers.html#代码块参数" class="sidebar-link">代码块参数</a></li><li class="sidebar-sub-header"><a href="/zh/guide/block-helpers.html#raw-代码块" class="sidebar-link">RAW 代码块</a></li></ul></li><li><a href="/zh/guide/builtin-helpers.html" class="sidebar-link">内置助手代码</a></li><li><a href="/zh/guide/hooks.html" class="sidebar-link">钩子</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="块助手代码"><a href="#块助手代码" class="header-anchor">#</a> 块助手代码</h1> <p>块助手代码使得调用通过传递上下文参数的代码块的迭代器或自定义函数成为可能。</p> <h2 id="基本代码块"><a href="#基本代码块" class="header-anchor">#</a> 基本代码块</h2> <p>出于演示目的，让我们先定义一个和没有块助手代码一样的块助手代码。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entry&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span></span><span class="hljs-template-variable">{{<span class="hljs-name">title</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;body&quot;</span>&gt;</span>
    </span><span class="hljs-template-tag">{{#<span class="hljs-name">noop</span>}}</span><span class="hljs-template-variable">{{<span class="hljs-name">body</span>}}</span><span class="hljs-template-tag">{{/<span class="hljs-name">noop</span>}}</span><span class="xml">
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</span></code></pre></div><p><code>noop</code> 助手代码（“no operation”的缩写）将收到一个 options 参数。这个 options 参数包含一个函数（<code>options.fn</code>），这个函数
和普通的 Handlebars 模板的效果是一样的。具体来说，这个函数接收一个上下文参数，并返回一个字符串。</p> <div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;noop&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Handlebars 将 <code>this</code> 指针作为上下文传递，因此你可以使用 <code>this</code> 调用该代码块以在上下文内使用代码块。</p> <p>通过这种方式定义的任何助手代码将优先于上下文中定义的字段。若要访问助手代码中的字段，可以使用路径引用。在上面的示例中，上
下文对象上名为 <code>noop</code> 的字段可以这样引用：</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-variable">{{<span class="hljs-name">./noop</span>}}</span><span class="xml">
</span></code></pre></div><h2 id="基本代码块的变化"><a href="#基本代码块的变化" class="header-anchor">#</a> 基本代码块的变化</h2> <p>为了更好地说明语法，让我们定义另一个块助手代码，为包装的文本添加一些标记。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entry&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span></span><span class="hljs-template-variable">{{<span class="hljs-name">title</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;body&quot;</span>&gt;</span>
    </span><span class="hljs-template-tag">{{#<span class="hljs-name">bold</span>}}</span><span class="hljs-template-variable">{{<span class="hljs-name">body</span>}}</span><span class="hljs-template-tag">{{/<span class="hljs-name">bold</span>}}</span><span class="xml">
  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</span></code></pre></div><p>粗体助手代码将添加标记以使其文本变为粗体。和以前一样，该函数将上下文作为输入并返回一个字符串。</p> <div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;bold&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Handlebars<span class="token punctuation">.</span>SafeString</span><span class="token punctuation">(</span><span class="token string">'&lt;div class=&quot;mybold&quot;&gt;'</span> <span class="token operator">+</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;&lt;/div&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="with-助手代码"><a href="#with-助手代码" class="header-anchor">#</a> <code>with</code> 助手代码</h2> <p><code>with</code> 助手代码演示了如何将参数传递给你的助手代码。当将参数传递给助手代码时，模板传入的任何上下文中都会接收该参数。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entry&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span></span><span class="hljs-template-variable">{{<span class="hljs-name">title</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  </span><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">with</span></span> story}}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;intro&quot;</span>&gt;</span></span><span class="hljs-template-variable">{{{<span class="hljs-name">intro</span>}}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;body&quot;</span>&gt;</span></span><span class="hljs-template-variable">{{{<span class="hljs-name">body</span>}}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  </span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">with</span></span>}}</span><span class="xml">
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</span></code></pre></div><p>如果你的 JSON 对象中包含深层嵌套属性，你就会发现这样的助手代码很有用。想要避免重复父名称。上面的模板可能要与这样的 JSON
搭配使用：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;First Post&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">story</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">intro</span><span class="token operator">:</span> <span class="token string">&quot;Before the jump&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token string">&quot;After the jump&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><div><p>实现这样的助手代码并不像实现 <code>noop</code> 一样。助手代码可以获取参数，并且参数的计算就像直接在 <code>{{mustache}}</code> 代码块中直接使用
的表达式一样。</p></div><div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;with&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>参数按照其传递的顺序传递给助手代码，最后是 options。</p> <h2 id="简单迭代"><a href="#简单迭代" class="header-anchor">#</a> 简单迭代</h2> <p>块助手代码的一个常见用法是使用它们来定义自定义迭代器。实际上，所有 Handlebars 内置助手代码都被定义为是常规的 Handlebars
帮助器。让我们看一下内置的 <code>each</code> 助手代码的工作方式。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;entry&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span></span><span class="hljs-template-variable">{{<span class="hljs-name">title</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
  </span><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">with</span></span> story}}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;intro&quot;</span>&gt;</span></span><span class="hljs-template-variable">{{{<span class="hljs-name">intro</span>}}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;body&quot;</span>&gt;</span></span><span class="hljs-template-variable">{{{<span class="hljs-name">body</span>}}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  </span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">with</span></span>}}</span><span class="xml">
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;comments&quot;</span>&gt;</span>
  </span><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">each</span></span> comments}}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;comment&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span></span><span class="hljs-template-variable">{{<span class="hljs-name">subject</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      </span><span class="hljs-template-variable">{{{<span class="hljs-name">body</span>}}}</span><span class="xml">
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  </span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">each</span></span>}}</span><span class="xml">
<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</span></code></pre></div><p>这种情况下，我们要为 comments 数组中的每个元素调用一次 <code>each</code> 的代码块。</p> <div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;each&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> context<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ret <span class="token operator">=</span> ret <span class="token operator">+</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span>context<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>这种情况下，我们遍历传递的参数中的项目，对每个项目调用一次该代码块。遍历完毕之后，我们建立一个 String 结果，然后返回它。</p> <p>此模式可用于实现更高级的迭代器。例如，让我们创建一个迭代器 <code>&lt;ul&gt;</code> 包装器，并将每个结果元素包装在 <code>&lt;li&gt;</code> 中。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-tag">{{#<span class="hljs-name">list</span> nav}}</span><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">{{<span class="hljs-name">url</span>}}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span></span><span class="hljs-template-variable">{{<span class="hljs-name">title</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</span><span class="hljs-template-tag">{{/<span class="hljs-name">list</span>}}</span><span class="xml">
</span></code></pre></div><p>你将使用类似以下内容的上下文来使用该模板：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">nav</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;http://www.yehudakatz.com&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;Katz Got Your Tongue&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;http://www.sproutcore.com/block&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;SproutCore Blog&quot;</span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这个助手代码类似于原始的 <code>each</code> 助手代码。</p> <div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token string">&quot;&lt;ul&gt;&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> j <span class="token operator">=</span> context<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> j<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ret <span class="token operator">=</span> ret <span class="token operator">+</span> <span class="token string">&quot;&lt;li&gt;&quot;</span> <span class="token operator">+</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span>context<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;&lt;/li&gt;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> ret <span class="token operator">+</span> <span class="token string">&quot;&lt;/ul&gt;&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>使用诸如 underscore.js 或是 SproutCore 的 Runtime Library 之类的库可能会使它更漂亮。例如，这是使用 SproutCore 的运行时库
时的情景：</p> <div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;&lt;ul&gt;&quot;</span> <span class="token operator">+</span>
    context
      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&lt;li&gt;&quot;</span> <span class="token operator">+</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;&lt;/li&gt;&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token string">&quot;&lt;/ul&gt;&quot;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="条件"><a href="#条件" class="header-anchor">#</a> 条件</h2> <p>块助手代码的另一个常见用例是计算条件表达式。与迭代器一样，Handlebars 内置有 <code>if</code> 和 <code>unless</code> 块助手代码。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> isActive}}</span><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;star.gif&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Active&quot;</span>&gt;</span>
</span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">if</span></span>}}</span><span class="xml">
</span></code></pre></div><p>控制结构通常不更改当前上下文，而是基于一些变量决定是否调用该代码块。</p> <div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;if&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">conditional<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>conditional<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>编写条件代码块时，你通常会希望模板可以提供“如果条件的计算结果为 false” 时助手代码应插入的 HTML 代码。Handlebars 通过提供
<code>else</code> 来解决这个问题。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> isActive}}</span><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;star.gif&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Active&quot;</span>&gt;</span>
</span><span class="hljs-template-tag">{{<span class="hljs-keyword">else</span>}}</span><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;cry.gif&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Inactive&quot;</span>&gt;</span>
</span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">if</span></span>}}</span><span class="xml">
</span></code></pre></div><p>Handlebars 使用 <code>options.inverse</code> 为 <code>else</code> 片段提供了代码块。你不需要检查是否存在 <code>else</code> 片段：Handlebars 将自动检测并
注册一个 <code>noop</code> 函数。</p> <div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;if&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">conditional<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>conditional<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> options<span class="token punctuation">.</span><span class="token function">inverse</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Handlebars 通过 options 参数给块助手代码提供附加元数据。下文有更多示例。</p> <p>通通过将后续的助手代码调用包含在 <code>else</code> 模板中，也可以连接条件语句。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">if</span></span> isActive}}</span><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;star.gif&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Active&quot;</span>&gt;</span>
</span><span class="hljs-template-tag">{{<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> isInactive}}</span><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">&quot;cry.gif&quot;</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">&quot;Inactive&quot;</span>&gt;</span>
</span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">if</span></span>}}</span><span class="xml">

</span></code></pre></div><p>后续调用中不必使用相同的助手代码，除非可以在 <code>else</code> 块中该助手代码可以和其他的助手代码一同使用。当助手代码不同时，关闭模
板语法应与打开的助手代码名称相匹配。</p> <h2 id="hash-参数"><a href="#hash-参数" class="header-anchor">#</a> Hash 参数</h2> <p>与普通的助手代码一样，块助手代码可以接受可选的 Hash 作为其最终参数。让我们重新看看 <code>list</code> 帮助器并使我们可以将任意数量的
可选属性添加到将要创建的 <code>&lt;ul&gt;</code> 元素中。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-tag">{{#<span class="hljs-name">list</span> nav <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;nav-bar&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;top&quot;</span>}}</span><span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;</span></span></span><span class="hljs-template-variable">{{<span class="hljs-name">url</span>}}</span><span class="xml"><span class="hljs-tag"><span class="hljs-string">&quot;</span>&gt;</span></span><span class="hljs-template-variable">{{<span class="hljs-name">title</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span>
</span><span class="hljs-template-tag">{{/<span class="hljs-name">list</span>}}</span><span class="xml">
</span></code></pre></div><p>Handlebars 在 <code>options.hash</code> 中提供最后一个 Hash。这样可以更轻松地接受可变数量的参数，同时也接受可选的 Hash。如果模板未
提供 Hash 参数，则 Handlebars 将自动传递空对象（<code>{}</code>），因此你无需检查 Hash 参数是否存在。</p> <div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> attrs <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>hash<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> key <span class="token operator">+</span> <span class="token string">'=&quot;'</span> <span class="token operator">+</span> options<span class="token punctuation">.</span>hash<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">'&quot;'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot; &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;&lt;ul &quot;</span> <span class="token operator">+</span>
    attrs <span class="token operator">+</span>
    <span class="token string">&quot;&gt;&quot;</span> <span class="token operator">+</span>
    context
      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;&lt;li&gt;&quot;</span> <span class="token operator">+</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;&lt;/li&gt;&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token string">&quot;&lt;/ul&gt;&quot;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Hash 参数提供了一种强大的方法，可以为块助手代码提供许多可选参数，而无需使得这件事因为参数位置的问题而变得更复杂。</p> <p>块助手代码还可以将局部变量注入其子模板。这对于添加不在上下文中的其他数据很有用。</p> <p>例如，当遍历列表时，你可以提供一个当前索引作为局部变量。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-tag">{{#<span class="hljs-name">list</span> array}}</span><span class="xml">
  </span><span class="hljs-template-variable">{{@<span class="hljs-name">index</span>}}</span><span class="xml">. </span><span class="hljs-template-variable">{{<span class="hljs-name">title</span>}}</span><span class="xml">
</span><span class="hljs-template-tag">{{/<span class="hljs-name">list</span>}}</span><span class="xml">
</span></code></pre></div><div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">context<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> out <span class="token operator">=</span> <span class="token string">&quot;&lt;ul&gt;&quot;</span><span class="token punctuation">,</span>
    data<span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    data <span class="token operator">=</span> Handlebars<span class="token punctuation">.</span><span class="token function">createFrame</span><span class="token punctuation">(</span>options<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> context<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      data<span class="token punctuation">.</span>index <span class="token operator">=</span> i<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    out <span class="token operator">+=</span> <span class="token string">&quot;&lt;li&gt;&quot;</span> <span class="token operator">+</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span>context<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">data</span><span class="token operator">:</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;&lt;/li&gt;&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  out <span class="token operator">+=</span> <span class="token string">&quot;&lt;/ul&gt;&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> out<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>通过 <code>data</code> 选项提供的局部变量在所有子作用域中都可用。</p> <p>可以通过路径查询来访问父范围中定义的局部变量。若要访问父级的 <code>index</code> ，可以使用 <code>@../index</code>。</p> <p>确保你创建的数据模型中每个助手代码只能接触到其自己的局部变量。否则，内层的助手代码可能意外地改变了外层的变量。</p> <p>还要在使用 <code>data</code> 前确保 <code>data</code> 已经被定义。局部变量很可能是按情况编译的，某些模板可能不会创建某些变量。</p> <h2 id="代码块参数"><a href="#代码块参数" class="header-anchor">#</a> 代码块参数</h2> <p>这是 Handlebars 3.0 中的新增功能，可以从支持的助手代码中接收命名参数。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">each</span></span> users <span class="hljs-keyword">as</span> |user userId|}}</span><span class="xml">
  Id: </span><span class="hljs-template-variable">{{<span class="hljs-name">userId</span>}}</span><span class="xml"> Name: </span><span class="hljs-template-variable">{{<span class="hljs-name">user.name</span>}}</span><span class="xml">
</span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">each</span></span>}}</span><span class="xml">
</span></code></pre></div><p>在这个示例中，<code>user</code> 将具有与当前上下文相同的值，而 <code>userId</code> 将具有索引迭代的值。</p> <p>这使得嵌套的助手代码能够避免一些可能因为局部变量命名的问题导致的冲突。</p> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">each</span></span> users <span class="hljs-keyword">as</span> |user userId|}}</span><span class="xml">
  </span><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">each</span></span> user.book <span class="hljs-keyword">as</span> |book bookId|}}</span><span class="xml">
    User Id: </span><span class="hljs-template-variable">{{<span class="hljs-name">userId</span>}}</span><span class="xml"> Book Id: </span><span class="hljs-template-variable">{{<span class="hljs-name">bookId</span>}}</span><span class="xml">
  </span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">each</span></span>}}</span><span class="xml">
</span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">each</span></span>}}</span><span class="xml">
</span></code></pre></div><p>许多 <a href="/zh/guide/builtin-helpers.html">内置助手代码</a> 支持代码块参数，而任何自定义的助手代码都可以通过 <code>blockParams</code> 字段提供参数。</p> <p>助手代码可以通过 <code>options.fn.blockParams</code> 字段确定模板引用的代码块参数的数量（整数）。这个值表示了子模板可以引用的代码块
参数的数量。超出此数量的参数将不会被引用，并且可以根据需要安全地忽略。这是可选的，并且传递给模板的所有其他参数都将被忽略
。</p> <h2 id="raw-代码块"><a href="#raw-代码块" class="header-anchor">#</a> RAW 代码块</h2> <p>RAW 代码块可用于处理不经由 mustache 模板处理的代码块。</p> <div title="Click to try out" class="handlebars-example-part"><span class="title">template</span> <a href="/zh/examples/raw-blocks.html" class="show-in-playground"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64" data-v-101f2525><g fill-rule="evenodd" stroke-linejoin="round" data-v-101f2525><path d="M227.059 899.053c2.55-73.662-43.23-144.975-62.127-176.173-35.678-58.903-94.85-119.215-137.5-175-9.596-12.552-14.786-49.151 3.75-68.75 18.609-19.676 47.526-18.971 65-8.75 48.776 28.529 65.847 50.928 100 97.5 11.68 15.928 34.944 62.726 35 98.75V257.88c0-36.53 34.4-62.204 70-60 35.6 2.203 64.769 33.137 65 61.25l2.5 303.75c-1.1-71.732 6.286-115.57 39.268-115.67 32.967-.101 46.789 48.063 48.232 118.17-1.443-73.023 9.456-93.69 43.964-94.268 34.509-.578 44.016 46.856 44.786 139.268.063-72.828 17.524-104.226 33.75-105 16.226-.775 56.873 32.177 57.134 106.605l.366 104.645c.112 32.014-46.568 56.55-46.844 88.598l-.808 93.977" fill="none" stroke-width="16" transform="matrix(.06113 0 0 .06961 11.98 1.372)" data-v-101f2525></path> <path d="M194.421 411.994a174.011 174.011 0 01-58.662-186.44 174.011 174.011 0 01151.61-123.351 174.011 174.011 0 01170.61 95.356 174.011 174.011 0 01-25.628 193.763" fill="none" stroke-width="32" stroke-opacity=".902" transform="matrix(.06113 0 0 .06961 11.98 1.372)" class="circle" data-v-101f2525></path> <path d="M83.027 416.954A261.017 261.017 0 01134.2 75.991a261.017 261.017 0 01344.705 7.25 261.017 261.017 0 0136.79 342.812" fill="none" stroke-width="32" stroke-opacity=".902" transform="matrix(.06113 0 0 .06961 11.98 1.372)" class="circle" data-v-101f2525></path></g></svg></a> <pre class="example-part-code" data-v-35d837e2><code spellcheck="false" class="ce-code-content hljs handlebars" data-v-35d837e2><span class="hljs-template-tag">{{{{<span class="hljs-name">raw-loud</span>}}}}</span><span class="xml">
  {{bar}}
</span><span class="hljs-template-tag">{{{{/<span class="hljs-name">raw-loud</span>}}}}</span><span class="xml">
</span></code></pre></div> <div class="language-handlebars extra-class"><pre class="language-handlebars"><code><span class="hljs-template-tag">{{{{<span class="hljs-name">raw-helper</span>}}}}</span><span class="xml">
  {{bar}}
</span><span class="hljs-template-tag">{{{{/<span class="hljs-name">raw-helper</span>}}}}</span><span class="xml">
</span></code></pre></div><p>将会执行 <code>raw-helper</code> 助手代码而不解释其内容。</p> <div class="language-js extra-class"><pre class="language-js"><code>Handlebars<span class="token punctuation">.</span><span class="token function">registerHelper</span><span class="token punctuation">(</span><span class="token string">&quot;raw-helper&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> options<span class="token punctuation">.</span><span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>将会渲染</p> <div class="language- extra-class"><pre class="language-text"><code>{{bar}}
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后更新:</span> <span class="time">2021/11/29 20:31:09</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/zh/guide/partials.html" class="prev">
        代码片段
      </a></span> <span class="next"><a href="/zh/guide/builtin-helpers.html">
        内置助手代码
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.66f79011.js" defer></script><script src="/assets/js/2.aef76e4d.js" defer></script><script src="/assets/js/158.8e8b55c0.js" defer></script><script src="/assets/js/9.07b9d2e0.js" defer></script><script src="/assets/js/13.9cff3425.js" defer></script>
  </body>
</html>
